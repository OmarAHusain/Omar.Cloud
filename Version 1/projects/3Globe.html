<!doctype html>
<html lang="en" class="no-js">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>OMAR.CLOUD 3 Globe Project</title>
		<meta name="description" content="Omar's cloud website">
		<meta name="keywords" content="programming, projects, fun, videos, youtube">
		<meta name="author" content="Omar Husain">
		<link rel="stylesheet" type="text/css" href="../css/base.css">
		<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
		<!-- Header and Footer script -->
		<script> 
			$(function(){
			  $("#globe").load("../common/globe.html"); 
			});
		</script> 
		<!-- Scripts for Three Globe -->
		<script src="/projects/js/three.js"></script>
  		<script src="/projects/js/three-trackballcontrols.min.js"></script>
 		<script src="/projects/js/three-globe.min.js"></script>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162856487-1"></script>
		<script>
			  window.dataLayer = window.dataLayer || [];
			  function gtag(){dataLayer.push(arguments);}
			  gtag('js', new Date());

			  gtag('config', 'UA-162856487-1');
			</script>
	</head>
	  <body class="demo-1">
		<!-- Google Tag Manager (noscript) -->
			<noscript>
				<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WLGJPV6" height="0" width="0" style="display:none;visibility:hidden"></iframe>
		  	</noscript>
		<!-- End Google Tag Manager (noscript) -->  
		<main>
			<div id="project" class="project"></div>
			<div id="globe"></div>
			<script>
				// Gen random paths
				const N_PATHS = 2;
				const MAX_POINTS_PER_LINE = 10000;
				const MAX_STEP_DEG = 1;
				const MAX_STEP_ALT = 0.015;
				const gData = [...Array(N_PATHS).keys()].map(() => {
				  let lat = (Math.random() - 0.5) * 90;
				  let lng = (Math.random() - 0.5) * 360;
				  let alt = 0;

				  return [[lat, lng, alt], ...[...Array(Math.round(Math.random() * MAX_POINTS_PER_LINE)).keys()].map(() => {
					lat += (Math.random() * 2 - 1) * MAX_STEP_DEG;
					lng += (Math.random() * 2 - 1) * MAX_STEP_DEG;
					alt += (Math.random() * 2 - 1) * MAX_STEP_ALT;
					alt = Math.max(0, alt);

					return [lat, lng, alt];
				  })];
				});

				const Globe = new ThreeGlobe({ animateIn: false })
				  .globeImageUrl('/projects/images/earth-dark.jpg')
				  .bumpImageUrl('/projects/images/earth-topology.png')
				  .pathsData(gData)
				  .pathColor(() => ['rgba(0,0,255,0.4)', 'rgba(255,0,0,0.4)'])
				  .pathDashLength(0.1)
				  .pathDashGap(0.004)
				  .pathDashAnimateTime(100000);

				setTimeout(() => {
				  Globe
					.pathPointAlt(pnt => pnt[2]) // set altitude accessor
					.pathTransitionDuration(4000)
				}, 6000);

				// Setup renderer
				const renderer = new THREE.WebGLRenderer();
				renderer.setSize(window.innerWidth, window.innerHeight);
				document.getElementById('project').appendChild(renderer.domElement);

				// Setup scene
				const scene = new THREE.Scene();
				scene.add(Globe);
				scene.add(new THREE.AmbientLight(0xbbbbbb));
				scene.add(new THREE.DirectionalLight(0xffffff, 0.6));

				// Setup camera
				const camera = new THREE.PerspectiveCamera();
				camera.aspect = window.innerWidth/window.innerHeight;
				camera.updateProjectionMatrix();
				camera.position.z = 300;

				// Add camera controls
				const tbControls = new TrackballControls(camera, renderer.domElement);
				tbControls.minDistance = 101;
				tbControls.rotateSpeed = 3;
				tbControls.zoomSpeed = 0.8;

				// Kick-off renderer
				(function animate() { // IIFE
				  // Frame cycle
				  tbControls.update();
				  renderer.render(scene, camera);
				  //Globe.rotate. += .01;
				  requestAnimationFrame(animate);
				})();
			  </script>
		</main>
	</body>
</html>
